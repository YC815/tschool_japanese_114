<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Êó•ÊñáÂ≠∏ÁøíÂç°Áâá</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "gray-bg": "#f5f5f5",
              "gray-card": "#ffffff",
              "gray-border": "#d4d4d4",
              "gray-text": "#404040",
              "gray-dark": "#1a1a1a",
              "gray-hover": "#fafafa",
            },
          },
        },
      };
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap");

      body {
        font-family: "Noto Sans TC", "Noto Sans JP", sans-serif;
        background-color: #f5f5f5;
      }

      .japanese-text {
        font-family: "Noto Sans JP", sans-serif;
      }

      .flat-card {
        background: #ffffff;
        border: 2px solid #d4d4d4;
        transition: border-color 0.2s ease, background-color 0.2s ease;
      }

      .flat-card:hover {
        background: #fafafa;
        border-color: #404040;
      }

      .play-button {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: #1a1a1a;
        border: 2px solid #404040;
        cursor: pointer;
        transition: background-color 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .play-button:hover {
        background: #404040;
      }

      .play-button:active {
        background: #000000;
      }

      .play-icon {
        width: 0;
        height: 0;
        border-left: 14px solid white;
        border-top: 9px solid transparent;
        border-bottom: 9px solid transparent;
        margin-left: 3px;
      }

      .play-button.playing {
        background: #ffffff;
        border-color: #1a1a1a;
      }

      .play-button.playing .play-icon {
        border: none;
        width: 14px;
        height: 14px;
        background: #1a1a1a;
        margin-left: 0;
      }

      .play-button.slow {
        background: #f5f5f5;
        border-color: #a3a3a3;
      }

      .play-button.slow:hover {
        background: #e5e5e5;
      }

      .play-button.slow:active {
        background: #d4d4d4;
      }

      .play-button.slow.playing {
        background: #ffffff;
        border-color: #1a1a1a;
      }

      .play-button.slow span {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .romaji-syllable {
        display: inline-block;
        background: linear-gradient(
          to bottom,
          transparent 0%,
          transparent 40%,
          #ffeb3b 40%,
          #ffeb3b 80%,
          transparent 80%
        );
        padding: 0 4px;
        margin: 0 2px;
        font-weight: 500;
      }

      /* ‰ΩçÁΩÆÂàáÊèõÊåâÈàïÊ®£Âºè */
      .position-toggle {
        padding: 8px 16px;
        border-radius: 8px;
        background: #ffffff;
        border: 2px solid #d4d4d4;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: 500;
        color: #404040;
        flex-shrink: 0;
        white-space: nowrap;
      }

      .position-toggle:hover {
        background: #fafafa;
        border-color: #404040;
      }

      .position-toggle:active {
        background: #f0f0f0;
      }

      /* ÊåâÈàï‰ΩçÁΩÆÊéßÂà∂ */
      .buttons-right .flex.items-start > div:first-child {
        order: 2;
      }

      .buttons-right .flex.items-start > div:last-child {
        order: 1;
      }

      /* ÂçÄÊÆµÊ®£Âºè */
      .section-container {
        margin-bottom: 48px;
      }

      .section-container:last-child {
        margin-bottom: 0;
      }

      .section-title {
        font-size: 24px;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 3px solid #d4d4d4;
      }

      .section-cards {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      /* ÂçÄÊÆµÂ∞éËà™Ê®£Âºè */
      .section-nav {
        display: flex;
        gap: 8px;
        justify-content: center;
        padding: 16px 0;
        margin-bottom: 24px;
        border-bottom: 2px solid #d4d4d4;
        flex-wrap: wrap;
      }

      .section-nav-btn {
        padding: 8px 16px;
        background: #ffffff;
        border: 2px solid #d4d4d4;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 16px;
        font-weight: 500;
        color: #404040;
        white-space: nowrap;
      }

      .section-nav-btn:hover {
        background: #fafafa;
        border-color: #404040;
      }

      .section-nav-btn:active {
        background: #f0f0f0;
      }

      .section-nav-btn.active {
        background: #1a1a1a;
        color: #ffffff;
        border-color: #1a1a1a;
      }

      /* ÊâãÊ©üÁâà RWD */
      @media (max-width: 640px) {
        .section-nav {
          justify-content: flex-start;
          overflow-x: auto;
          flex-wrap: nowrap;
          -webkit-overflow-scrolling: touch;
          scrollbar-width: none;
        }

        .section-nav::-webkit-scrollbar {
          display: none;
        }

        .section-nav-btn {
          flex-shrink: 0;
        }
      }

      /* ÂõûÂà∞È†ÇÁ´ØÊåâÈàï */
      .scroll-to-top {
        position: fixed;
        bottom: 32px;
        right: 32px;
        width: 56px;
        height: 56px;
        background: #1a1a1a;
        color: #ffffff;
        border: 2px solid #404040;
        border-radius: 50%;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        opacity: 0;
        visibility: hidden;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .scroll-to-top.left {
        right: auto;
        left: 32px;
      }

      .scroll-to-top.show {
        opacity: 1;
        visibility: visible;
      }

      .scroll-to-top:hover {
        background: #404040;
        transform: translateY(-4px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      }

      .scroll-to-top:active {
        background: #000000;
        transform: translateY(-2px);
      }

      @media (max-width: 640px) {
        .scroll-to-top {
          width: 48px;
          height: 48px;
          bottom: 24px;
          right: 24px;
          font-size: 20px;
        }

        .scroll-to-top.left {
          right: auto;
          left: 24px;
        }
      }
    </style>
  </head>
  <body class="bg-gray-bg min-h-screen py-8 px-4 sm:px-6 lg:px-8">
    <div class="max-w-3xl mx-auto">
      <!-- Header -->
      <header class="mb-8">
        <div class="flex items-center justify-between mb-2">
          <h1
            class="text-3xl sm:text-4xl font-bold text-gray-dark flex-1 text-center"
          >
            üìò Êó•ÊñáÂ≠∏ÁøíÂç°Áâá
          </h1>
          <!-- ÂàáÊèõÊåâÈàï -->
          <button
            id="toggle-position"
            class="position-toggle"
            title="ÂàáÊèõÊåâÈàï‰ΩçÁΩÆ"
          >
            <span id="position-icon">Èù†Â∑¶</span>
          </button>
        </div>
        <p class="text-gray-text text-base text-center">
          Made by
          <a
            href="https://yushun.chen.zone"
            target="_blank"
            class="text-gray-dark underline font-medium"
            >Yushun</a
          >
        </p>
      </header>

      <!-- Section Navigation -->
      <nav id="section-nav" class="section-nav">
        <!-- Navigation buttons will be inserted here by JavaScript -->
      </nav>

      <!-- Cards Container -->
      <div id="list-container">
        <!-- Sections and cards will be inserted here by JavaScript -->
      </div>

      <!-- Loading State -->
      <div id="loading" class="text-center text-gray-text text-xl">
        ËºâÂÖ•‰∏≠...
      </div>

      <!-- Error State -->
      <div id="error" class="hidden text-center text-gray-dark text-xl">
        ËºâÂÖ•Ë≥áÊñôÂ§±ÊïóÔºåË´ãÊ™¢Êü• data.json Ê™îÊ°à
      </div>
    </div>

    <!-- Scroll to Top Button -->
    <button id="scroll-to-top" class="scroll-to-top" aria-label="ÂõûÂà∞È†ÇÁ´Ø">
      ‚Üë
    </button>

    <script>
      // ÊåâÈàï‰ΩçÁΩÆÁãÄÊÖãÁÆ°ÁêÜ
      let buttonsPosition = localStorage.getItem("buttonsPosition") || "left";

      // ÂàùÂßãÂåñ‰ΩçÁΩÆ
      function initializePosition() {
        const container = document.getElementById("list-container");
        const icon = document.getElementById("position-icon");
        const scrollBtn = document.getElementById("scroll-to-top");

        if (buttonsPosition === "right") {
          container.classList.add("buttons-right");
          icon.textContent = "Èù†Âè≥";
          if (scrollBtn) scrollBtn.classList.remove("left");
        } else {
          container.classList.remove("buttons-right");
          icon.textContent = "Èù†Â∑¶";
          if (scrollBtn) scrollBtn.classList.add("left");
        }
      }

      // ÂàáÊèõ‰ΩçÁΩÆ
      function togglePosition() {
        buttonsPosition = buttonsPosition === "left" ? "right" : "left";
        localStorage.setItem("buttonsPosition", buttonsPosition);
        initializePosition();
      }

      // ÊªæÂãïÂà∞ÊåáÂÆöÂçÄÊÆµ
      function scrollToSection(sectionName) {
        const sectionId = "section-" + encodeURIComponent(sectionName);
        const section = document.getElementById(sectionId);

        if (section) {
          section.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });
        }
      }

      // Âª∫Á´ãÂçÄÊÆµÂ∞éËà™Âàó
      function createSectionNav(sectionNames) {
        const nav = document.getElementById("section-nav");

        sectionNames.forEach((name) => {
          const btn = document.createElement("button");
          btn.className = "section-nav-btn";
          btn.textContent = name;
          btn.onclick = () => scrollToSection(name);
          nav.appendChild(btn);
        });
      }

      async function loadData() {
        const loading = document.getElementById("loading");
        const error = document.getElementById("error");
        const container = document.getElementById("list-container");

        try {
          const response = await fetch("data.json");
          if (!response.ok) throw new Error("Failed to fetch");

          const data = await response.json();

          // Hide loading
          loading.classList.add("hidden");

          // Create section navigation
          createSectionNav(Object.keys(data));

          // Iterate through sections
          Object.entries(data).forEach(([sectionName, items]) => {
            const section = createSection(sectionName, items);
            container.appendChild(section);
          });
        } catch (err) {
          loading.classList.add("hidden");
          error.classList.remove("hidden");
          console.error("Error loading data:", err);
        }
      }

      function createSection(sectionName, items) {
        const section = document.createElement("div");
        section.className = "section-container";
        section.id = "section-" + encodeURIComponent(sectionName);

        const title = document.createElement("h2");
        title.className = "section-title";
        title.textContent = sectionName;

        const cardsContainer = document.createElement("div");
        cardsContainer.className = "section-cards";

        items.forEach((item) => {
          const card = createListItem(item);
          cardsContainer.appendChild(card);
        });

        section.appendChild(title);
        section.appendChild(cardsContainer);

        return section;
      }

      function formatRomaji(romaji) {
        return romaji
          .split("-")
          .map((syllable) => `<span class="romaji-syllable">${syllable}</span>`)
          .join("");
      }

      function createListItem(item) {
        const card = document.createElement("div");
        card.className = "flat-card rounded-lg p-6";

        const hasNote = item.Ë®ªËß£ && item.Ë®ªËß£.trim() !== "";
        const emoji = item.emoji || "üí¨";

        card.innerHTML = `
                <div class="flex items-start gap-4">
                    <!-- Play Buttons -->
                    <div class="flex flex-col gap-2 flex-shrink-0">
                        <button class="play-button" data-audio="${
                          item.Èü≥Ê™î ? "voice/" + item.Èü≥Ê™î : ""
                        }" data-speed="1.0" ${
          !item.Èü≥Ê™î ? 'disabled style="opacity:0.3;cursor:not-allowed;"' : ""
        }>
                            <div class="play-icon"></div>
                        </button>
                        <button class="play-button slow" data-audio="${
                          item.Èü≥Ê™î ? "voice/" + item.Èü≥Ê™î : ""
                        }" data-speed="0.50" ${
          !item.Èü≥Ê™î ? 'disabled style="opacity:0.3;cursor:not-allowed;"' : ""
        }>
                            <span class="text-xl leading-none">üê¢</span>
                        </button>
                    </div>

                    <!-- Content -->
                    <div class="flex-1 min-w-0">
                        <!-- Chinese with emoji -->
                        <div class="mb-3">
                            <p class="text-gray-dark font-semibold text-lg leading-relaxed">
                                ${emoji} ${item.‰∏≠Êñá}
                            </p>
                        </div>

                        <!-- Japanese -->
                        <div class="mb-2 pl-6">
                            <p class="text-gray-dark japanese-text font-bold text-3xl leading-relaxed">
                                ${item.Êó•Êñá}
                            </p>
                        </div>

                        <!-- Romaji -->
                        <div class="mb-3 pl-6">
                            <p class="text-gray-text text-xl tracking-wide leading-relaxed">
                                ${formatRomaji(item.ÁæÖÈ¶¨ÊãºÈü≥)}
                            </p>
                        </div>

                        ${
                          hasNote
                            ? `
                        <!-- Note Section -->
                        <div class="mt-4 pt-3 border-t border-gray-border">
                            <div class="bg-gray-hover rounded-lg px-4 py-2 border border-gray-border">
                                <p class="text-gray-text text-sm leading-relaxed">
                                    üí° ${item.Ë®ªËß£}
                                </p>
                            </div>
                        </div>
                        `
                            : ""
                        }
                    </div>
                </div>
            `;

        return card;
      }

      // Audio player
      let currentAudio = null;
      let currentButton = null;

      function playAudio(audioFile, button, speed = 1.0) {
        // Stop current audio if playing
        if (currentAudio) {
          currentAudio.pause();
          currentAudio.currentTime = 0;
          if (currentButton) {
            currentButton.classList.remove("playing");
          }
        }

        // If clicking the same button, just stop
        if (currentButton === button && currentAudio) {
          currentAudio = null;
          currentButton = null;
          return;
        }

        // Play new audio
        currentAudio = new Audio(audioFile);
        currentAudio.playbackRate = speed;
        currentButton = button;
        button.classList.add("playing");

        currentAudio.play().catch((err) => {
          console.error("Audio playback failed:", err);
          button.classList.remove("playing");
        });

        currentAudio.addEventListener("ended", () => {
          button.classList.remove("playing");
          currentAudio = null;
          currentButton = null;
        });
      }

      // Add click listeners to play buttons
      document.addEventListener("click", (e) => {
        const button = e.target.closest(".play-button");
        if (button && !button.disabled) {
          const audioFile = button.dataset.audio;
          const speed = parseFloat(button.dataset.speed) || 1.0;
          if (audioFile) {
            playAudio(audioFile, button, speed);
          }
        }
      });

      // Scroll to top functionality
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      function toggleScrollToTopButton() {
        const scrollBtn = document.getElementById("scroll-to-top");
        if (window.scrollY > 300) {
          scrollBtn.classList.add("show");
        } else {
          scrollBtn.classList.remove("show");
        }
      }

      // Load data when page loads
      document.addEventListener("DOMContentLoaded", () => {
        initializePosition();

        const toggleBtn = document.getElementById("toggle-position");
        toggleBtn.addEventListener("click", togglePosition);

        const scrollBtn = document.getElementById("scroll-to-top");
        scrollBtn.addEventListener("click", scrollToTop);

        window.addEventListener("scroll", toggleScrollToTopButton);

        loadData();
      });
    </script>
  </body>
</html>
